{% extends "template.html" %}
{% block conteudo %}

<div class="card">
  <h5 class="card-header">Cadastro básico/Publicação</h5>
  <div class="card-body">

    <form method="GET" action="/publicacao/pesquisar" class="row g-3">
    
      <div class="row">
        <div class="col-md-3">
          <label for="autor" class="form-label">Autor</label>
          <select class="form-control" name="idAutor" id="idAutor">
            <option value="">--Todos--</option>
            {% for item_ in listaAutores %}
              <option value="{{item_.id}}">{{item_.nome}}</option>
            {% endfor %}
        </select>
        </div>

      <div class="col-md-2">
        <label for="categoria" class="form-label">Categoria</label>
        <select class="form-control" id="idCategoria" name="idCategoria">
          <option value="">--Todos--</option>
          {% for item_ in listaCategoria %}
            <option value="{{item_.id}}">{{item_.nome}}</option>
          {% endfor %}
        </select>
      </div>

      <div class="col-md-3">
        <label for="editora" class="form-label">Editora</label>
        <select class="form-control" id="idEditora" name="idEditora">
          <option value="">--Todos--</option>
          {% for item_ in listaEditora %}
            <option value="{{item_.id}}">{{item_.nome}}</option>
          {% endfor %} 
        </select>
      </div>

    <div class="col-md-3">
      <label for="idTipo" class="form-label">Tipo</label>
      <select class="form-control" name="idTipo" id="idTipo">
          <option value="">--Todos--</option>
          <option value="1">Livro</option>
          <option value="2">Revista</option>
      </select>
    </div>

    <div class="col-md-2">
      <label for="ano" class="form-label">Ano</label>
      <input type="number" class="form-control" id="ano" name="ano">
    </div>

    <div class="col-md-4">
      <label for="titulo" class="form-label">Título</label>
      <input type="text" class="form-control" id="titulo" name="titulo">
    </div>
    
    <div class="col-md-2">
      <label for="status" class="form-label">Status</label>
      <select name="status" class="form-control">
        <option value="">--Todos--</option>
        <option value="0">Pendente</option>
        <option value="1">Disponível</option>
      </select>
    </div>

      <div class="col-md-2">
        <br/>
        <button type="submit" class="btn btn-primary">Buscar</button>
      </div>
    </div>

    </form>   

    <hr/>

    <div class="row">
      <div class="col-12 " style="text-align:right;">
        <a href="/publicacao/cadastro" type="button" class="btn btn-primary" >Nova Publicação</a>
      </div>
    </div>
    
    <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Autor</th>
            <th scope="col">Categoria</th>
            <th scope="col">Editora</th>
            <th scope="col">Tipo</th>
            <th scope="col">Ano</th>
            <th scope="col">Título</th>
            <th scope="col">Descrição</th>
            <th scope="col">Quantidade Total</th>
            <th scope="col">Quantidade Disponível</th>
            <th scope="col" style="text-align: right;">Ação</th>
          </tr>
        </thead>
        <tbody>
          {% for item in lista %}
    
          <tr>
            <th scope="row"> {{item.id}}</th>
            <td> {{item.autor.nome}}</td>
            <td> {{item.categoria.nome}}</td>
            <td> {{item.editora.nome}}</td>

            {% if item.idTipo == 1 %}
              <td>Livro</td>
            {% else %}
              <td>Revista</td>
            {% endif %}

            <td> {{item.ano}}</td>
            <td> {{item.titulo}}</td>
            <td> {{item.descricao}}</td>
            <td> {{item.qtdeTotal}}</td>
            <td> {{item.qtdeDisponivel}}</td>
            <td style="text-align: right;">
              <div class="btn-group">
                <a href="/publicacao/cadastro/{{item.id}}" type="button" class="btn btn-warning" >Alterar</a>
                <a href="/exemplar" type="button" class="btn btn-info" >Exemplar</a>
                <a onclick="Excluir('{{item.id}}')" data-id="{{item.id}}" type="button" class="btn btn-danger" >Excluir</a>
              </div>
            </td>
    
          </tr>
    
            {% endfor %}
    
        </tbody>
      </table>
  </div>
</div>

  <script src="{{url_for('static', filename='publicacao.js')}}"></script>

  {% endblock %}